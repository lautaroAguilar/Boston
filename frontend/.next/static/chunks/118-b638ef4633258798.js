"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[118],{44026:(e,t,a)=>{a.d(t,{A:()=>r});let r=(()=>{let e=window.location.hostname;return e.includes("sistema-test.bostoncelop.com.ar")?{API_URL:"https://api.sistema-test.bostoncelop.com.ar/api"}:e.includes("sistema.bostoncelop.com.ar")?{API_URL:"https://api.sistema.bostoncelop.com.ar/api"}:{API_URL:"http://localhost:3000/api"}})()},16118:(e,t,a)=>{a.d(t,{J:()=>l,P:()=>u});var r=a(95155),n=a(12115),c=a(76046),o=a(44026),s=a(72971);let i=(0,n.createContext)(),l=e=>{let{children:t}=e,{setSnackbarMessage:a,setSnackbarErrorMessage:l}=(0,s.M)(),[u,d]=(0,n.useState)(!1),[m,y]=(0,n.useState)({}),[h,p]=(0,n.useState)(!1),[f,A]=(0,n.useState)(!1),[w,_]=(0,n.useState)([]),[g,j]=(0,n.useState)([]),[P,E]=(0,n.useState)([]),[b,S]=(0,n.useState)([]),[T,L]=(0,n.useState)([]),R=(0,c.useRouter)();async function k(e){y({}),d("");try{let t=await fetch("".concat(o.A.API_URL,"/companies"),{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({name:e.name,cuit:Number(e.cuit),business_name:e.business_name,first_survey_link:e.first_survey_link,second_survey_link:e.second_survey_link})});if(201!==t.status){let e=await t.json();if(Array.isArray(e)){let t=e.reduce((e,t)=>(e[t.path[0]]=t.message,e),{});y(t)}else l(e.error);return}return await t.json()}catch(e){d(e.error),console.error("Error al crear empresa: ",e)}}async function I(e,t){y({}),d("");try{let r=await fetch("".concat(o.A.API_URL,"/companies/").concat(t,"/cost-centers"),{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({name:e.name})});if(201!==r.status){let e=await r.json();if(Array.isArray(e)){let t=e.reduce((e,t)=>(e[t.path[0]]=t.message,e),{});y(t)}else l(e.error);return}let n=await r.json();return a("Nuevo centro de costo agregado correctamente."),A(e=>!e),n}catch(e){d(e.error),console.error("Error al crear el centro de costo: ",e)}}async function U(e,t){y({}),d("");try{let r=await fetch("".concat(o.A.API_URL,"/companies/").concat(t,"/sectors"),{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({name:e.name})});if(201!==r.status){let e=await r.json();if(Array.isArray(e)){let t=e.reduce((e,t)=>(e[t.path[0]]=t.message,e),{});y(t)}else l(e.error);return}let n=await r.json();return a("Nuevo sector agregado correctamente."),A(e=>!e),n}catch(e){d(e.error),console.error("Error al crear el Sector: ",e)}}async function v(e,t){y({}),d("");try{let r=await fetch("".concat(o.A.API_URL,"/companies/").concat(t,"/contacts"),{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({name:e.name,email:e.email,notes:e.notes})});if(201!==r.status){let e=await r.json();if(Array.isArray(e)){let t=e.reduce((e,t)=>(e[t.path[0]]=t.message,e),{});y(t)}else l(e.error);return}let n=await r.json();return a("Nuevo contacto agregado correctamente."),A(e=>!e),n}catch(e){d(e.error),console.error("Error al crear el centro de costo: ",e)}}let C=async e=>{try{let t=await fetch("".concat(o.A.API_URL,"/companies/").concat(e),{method:"GET",credentials:"include"});return await t.json()}catch(e){console.log("Fallo al buscar empresas:",data.error)}},N=async e=>{try{let t=await fetch("".concat(o.A.API_URL,"/companies/").concat(e,"/cost-centers"),{method:"GET",credentials:"include"}),a=await t.json();return j(a),a}catch(e){return console.log("Fallo al buscar empresas:",e),[]}},O=async e=>{try{let t=await fetch("".concat(o.A.API_URL,"/companies/").concat(e,"/contacts"),{method:"GET",credentials:"include"}),a=await t.json();return E(a),a}catch(e){return console.log("Fallo al buscar empresas:",e),[]}},G=async e=>{try{let t=await fetch("".concat(o.A.API_URL,"/companies/").concat(e,"/sectors"),{method:"GET",credentials:"include"}),a=await t.json();return S(a),a}catch(e){return console.log("Fallo al buscar empresas:",e),[]}},J=async()=>{try{let e=await fetch("".concat(o.A.API_URL,"/companies"),{method:"GET",credentials:"include"}),t=await e.json();if(!Array.isArray(t))return d("No se encontraron empresas"),null;let a=await Promise.all(t.map(async e=>{let[t,a,r]=await Promise.all([N(e.id),O(e.id),G(e.id)]),n=e=>Array.isArray(e)?e:e.data||[],c=n(t).filter(t=>t.company_id===e.id),o=n(a).filter(t=>t.company_id===e.id),s=n(r).filter(t=>t.company_id===e.id);return{...e,costCenters:c,contacts:o,sectors:s}}));L(a)}catch(e){console.error("Fallo al buscar empresas:",e)}},x=async()=>{try{let e=await fetch("".concat(o.A.API_URL,"/companies"),{method:"GET",credentials:"include"}),t=await e.json();e.ok?Array.isArray(t)?_(t):t.success&&0===t.data.length&&(_([]),l(t.message)):l(t.message)}catch(e){l("Error de red al buscar empresas"),console.error("Error al buscar empresas:",e)}};async function F(e,t){try{let r=await fetch("".concat(o.A.API_URL,"/companies/").concat(t),{method:"PATCH",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({name:e.name,cuit:Number(e.cuit),business_name:e.business_name,first_survey_link:e.first_survey_link,second_survey_link:e.second_survey_link})});if(!r.ok){let e=await r.json();l(e.error);return}let n=await r.json();return a(n.message),A(e=>!e),n}catch(e){console.error("Error al actualizar la empresa: ",e)}}async function z(e){try{let t=await fetch("".concat(o.A.API_URL,"/companies/").concat(e),{method:"delete",credentials:"include"}),r=await t.json();t.ok||l(r.error),a(r.message),R.replace("/empresas")}catch(e){console.error("error al eliminar empresa",e)}}async function H(e,t,r){y({}),d("");try{let n=await fetch("".concat(o.A.API_URL,"/companies/").concat(t,"/cost-centers/").concat(r),{method:"PATCH",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({name:e.name})});if(!n.ok){let e=await n.json();l(e.error);return}let c=await n.json();return a(c.message),A(e=>!e),c}catch(e){console.error("Error al actualizar el centro de costo: ",e)}}async function D(e,t){d("");try{let r=await fetch("".concat(o.A.API_URL,"/companies/").concat(e,"/cost-centers/").concat(t),{method:"DELETE",credentials:"include"});if(!r.ok){let e=await r.json();l(e.error);return}let n=await r.json();return a(n.message),A(e=>!e),n}catch(e){console.error("Error al eliminar el centro de costo: ",e)}}async function M(e,t,r){y({}),d("");try{let n=await fetch("".concat(o.A.API_URL,"/companies/").concat(t,"/contacts/").concat(r),{method:"PATCH",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({name:e.name,email:e.email,notes:e.notes})});if(!n.ok){let e=await n.json();console.log(e.error),l(e.error);return}let c=await n.json();return a(c.message),A(e=>!e),c}catch(e){console.error("Error al actualizar el contacto: ",e)}}async function q(e,t){d("");try{let r=await fetch("".concat(o.A.API_URL,"/companies/").concat(e,"/contacts/").concat(t),{method:"DELETE",credentials:"include"});if(!r.ok){let e=await r.json();l(e.error);return}let n=await r.json();return a(n.message),A(e=>!e),n}catch(e){console.error("Error al eliminar el contacto: ",e)}}async function B(e,t,r){y({}),d("");try{let n=await fetch("".concat(o.A.API_URL,"/companies/").concat(t,"/sectors/").concat(r),{method:"PATCH",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({name:e.name})});if(!n.ok){let e=await n.json();l(e.error);return}let c=await n.json();return a(c.message),A(e=>!e),c}catch(e){console.error("Error al actualizar el sector: ",e)}}async function K(e,t){d("");try{let r=await fetch("".concat(o.A.API_URL,"/companies/").concat(e,"/sectors/").concat(t),{method:"DELETE",credentials:"include"});if(!r.ok){let e=await r.json();l(e.error);return}let n=await r.json();return a(n.message),A(e=>!e),n}catch(e){console.error("Error al eliminar el sector: ",e)}}return(0,r.jsx)(i.Provider,{value:{companiesInfo:w,companies:T,costCenters:g,contacts:P,sectors:b,handleSubmitCompany:k,handleSubmitCostCenter:I,handleSubmitContact:v,handleSubmitSector:U,errorMessage:u,formErrors:m,setErrorMessage:d,fetchCompany:C,fetchCompaniesInfo:J,fetchCostCenters:N,fetchContacts:O,fetchSectors:G,fetchCompaniesToSelect:x,updateCompany:F,deleteCompany:z,updateCostCenter:H,deleteCostCenter:D,updateContact:M,deleteContact:q,updateSector:B,deleteSector:K,updated:f,setUpdated:A,companyCreated:h,setCompanyCreated:p},children:t})},u=()=>(0,n.useContext)(i)},72971:(e,t,a)=>{a.d(t,{M:()=>i,q:()=>s});var r=a(95155),n=a(12115),c=a(44026);let o=(0,n.createContext)();function s(e){let{children:t}=e,[a,s]=(0,n.useState)(""),[i,l]=(0,n.useState)(null),[u,d]=(0,n.useState)(!1),[m,y]=(0,n.useState)(""),[h,p]=(0,n.useState)(""),[f,A]=(0,n.useState)([]),[w,_]=(0,n.useState)([]),[g,j]=(0,n.useState)([]);async function P(){try{let e=await fetch("".concat(c.A.API_URL,"/settings/modules"),{method:"GET",credentials:"include"}),t=await e.json();return e.ok||p(t.message),j(t),t}catch(e){console.log("error al buscar los m\xf3dulos",e)}}async function E(){try{let e=await fetch("".concat(c.A.API_URL,"/settings/languages"),{method:"GET",credentials:"include"}),t=await e.json();return e.ok||p(t.message),A(t),t}catch(e){console.log("error al buscar los idiomas",e)}}async function b(){try{let e=await fetch("".concat(c.A.API_URL,"/settings/levels"),{method:"GET",credentials:"include"}),t=await e.json();return e.ok||p(t.message),_(t),t}catch(e){console.log("error al buscar los niveles",e)}}return(0,r.jsx)(o.Provider,{value:{selectedCompany:a,toolbarButtonAction:i,openSnackbar:u,snackbarMessage:m,snackbarErrorMessage:h,setSelectedCompany:s,setToolbarButtonAction:l,setOpenSnackbar:d,setSnackbarMessage:y,setSnackbarErrorMessage:p,fetchModules:P,fetchLanguages:E,fetchLevels:b,languages:f,levels:w,modules:g},children:t})}function i(){return(0,n.useContext)(o)}}}]);