(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[981],{19066:(e,a,n)=>{Promise.resolve().then(n.bind(n,21025))},21025:(e,a,n)=>{"use strict";n.r(a),n.d(a,{default:()=>N});var l=n(95155),t=n(12115),r=n(48173),s=n.n(r),i=n(10979),o=n(22282),d=n(55295),u=n(92608),c=n(78562),m=n(9561),h=n(93717),v=n(64527),p=n(78039),f=n(11896),x=n(89026),g=n(63219),b=n(72234),j=n(16118),C=n(72971),A=n(57432),_=n(43415);let y=_.z.object({name:_.z.string({invalid_type_error:"No puedes enviar este campo vac\xedo"}).min(1,"El nombre de la empresa es requerido"),cuit:_.z.coerce.number({invalid_type_error:"El CUIT debe ser un n\xfamero"}).min(1,"El CUIT es requerido"),business_name:_.z.string({invalid_type_error:"No puedes enviar este campo vac\xedo"}).min(1,"La raz\xf3n social es requerida"),first_survey_link:_.z.union([_.z.string().url({message:"El enlace de la encuesta debe ser una URL v\xe1lida"}),_.z.literal(""),_.z.null()]).optional(),second_survey_link:_.z.union([_.z.string().url({message:"El enlace de la encuesta debe ser una URL v\xe1lida"}),_.z.literal(""),_.z.null()]).optional()}),z=_.z.object({name:_.z.string().min(1,"El nombre no puede estar vac\xedo"),email:_.z.string().min(1,"El email no puede estar vac\xedo").email("El email del contacto debe ser v\xe1lido"),notes:_.z.string().optional()}),E=_.z.object({name:_.z.string({required_error:"El nombre del centro de costo es requerido"}).min(1,"El nombre del centro de costo no puede estar vac\xedo")}),S=_.z.object({name:_.z.string({required_error:"El nombre del sector es requerido"}).min(1,"El nombre del sector no puede estar vac\xedo")});var w=n(44026);function k(e){let{value:a}=e,[n,r]=t.useState(!1);return(0,l.jsxs)(i.default,{flexDirection:"row",gap:1,alignItems:"center",children:[a&&a.length>10&&(0,l.jsx)(o.A,{sx:{height:30,padding:0,margin:0,minWidth:30},onClick:()=>r(!n),children:n?(0,l.jsx)(x.A,{}):(0,l.jsx)(g.A,{})}),n?a:a&&a.length>10?"".concat(a.slice(0,10),"..."):a,"\xa0"]})}let D=[{field:"id",headerName:"ID",minWidth:150,renderCell:e=>(0,l.jsx)(k,{...e})},{field:"name",headerName:"Nombre",minWidth:150,flex:1,renderCell:e=>(0,l.jsx)(s(),{href:"/empresas/".concat(e.row.id),style:{textDecoration:"none",color:"inherit",textTransform:"uppercase"},children:e.value})},{field:"business_name",headerName:"Raz\xf3n social",minWidth:150,flex:1},{field:"cuit",headerName:"CUIT",minWidth:150,flex:1},{field:"costCenters",headerName:"Centros de costo",minWidth:150,flex:1,renderCell:e=>{var a,n,t,r;let s=(null===(a=e.value)||void 0===a?void 0:a.success)===!0&&(null===(t=e.value)||void 0===t?void 0:null===(n=t.data)||void 0===n?void 0:n.length)===0?e.value.message:null===(r=e.value)||void 0===r?void 0:r.map(e=>"- ".concat(e.cost_center_name)).join("\n");return(0,l.jsx)(k,{value:s})}},{field:"sectors",headerName:"Sectores",minWidth:150,flex:1,renderCell:e=>{var a,n,t,r;let s=(null===(a=e.value)||void 0===a?void 0:a.success)===!0&&(null===(t=e.value)||void 0===t?void 0:null===(n=t.data)||void 0===n?void 0:n.length)===0?e.value.message:null===(r=e.value)||void 0===r?void 0:r.map(e=>"- ".concat(e.sector_name)).join("\n");return(0,l.jsx)(k,{value:s})}}];function N(){let{companyCreated:e,setCompanyCreated:a,fetchCompaniesInfo:n,companies:r,errorMessage:s,setErrorMessage:o}=(0,j.P)(),{setToolbarButtonAction:x,setOpenSnackbar:g,snackbarMessage:_,snackbarErrorMessage:k,setSnackbarMessage:N,setSnackbarErrorMessage:q}=(0,C.M)(),M=(0,d.A)("(max-width:600px)"),[W,P]=(0,t.useState)(!1),[T,I]=(0,t.useState)({name:"",cuit:"",business_name:"",first_survey_link:"",second_survey_link:""}),[R,U]=(0,t.useState)({name:""}),[V,G]=(0,t.useState)({name:"",email:"",notes:""}),[F,L]=(0,t.useState)({name:""}),O=[{label:"Datos de la Empresa",description:"Completa los datos principales de la empresa",schema:y,fields:[{name:"name",label:"Nombre",required:!0},{name:"business_name",label:"Raz\xf3n Social",required:!0},{name:"cuit",label:"CUIT",required:!0,type:"number"},{name:"first_survey_link",label:"Primer encuesta"},{name:"second_survey_link",label:"Segunda encuesta"}],values:T,setValues:I,errorMessage:s},{label:"Centro de Costo",description:"Agrega un Centro de Costo a la nueva empresa",schema:E,fields:[{name:"name",label:"Centro de costo"}],values:R,setValues:U,errorMessage:s},{label:"Sector",description:"Agrega un Sector a la nueva empresa",schema:S,fields:[{name:"name",label:"Sector"}],values:F,setValues:L,errorMessage:s},{label:"Contacto",description:"Agrega un Contacto asociado a la nueva empresa",schema:z,fields:[{name:"name",label:"Nombre"},{name:"email",label:"Email"},{name:"notes",label:"Notas"}],values:V,setValues:G,errorMessage:s}],H=(0,h.A)(f.F);function J(){P(!0),o(!1)}async function Y(){try{let e=await fetch("".concat(w.A.API_URL,"/companies/fullCompany"),{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({companyData:T,contactData:V,costCenterData:R,sectorData:F})}),n=await e.json();if(!e.ok){q(n.error);return}return N("Empresa creada correctamente"),a(!0),P(!1),I({}),U({}),L({}),G({}),n}catch(e){console.error("Error al crear entidades: ",e)}}return(0,t.useEffect)(()=>{x({label:"Crear nueva",action:J,icon:(0,l.jsx)(b.default,{})})},[x]),(0,t.useEffect)(()=>{(_||k)&&g(!0)},[_,k]),(0,t.useEffect)(()=>{n()},[e]),(0,l.jsxs)(i.default,{sx:{height:"100%",width:"100%",display:"flex",justifyContent:"center",alignItems:"center"},children:[(0,l.jsx)(v.A,{theme:H,children:(0,l.jsx)(p.z,{columns:D,rows:r,getEstimatedRowHeight:()=>100,getRowHeight:()=>"auto",sx:{width:"100%","&.MuiDataGrid-root--densityCompact .MuiDataGrid-cell":{py:1},"&.MuiDataGrid-root--densityStandard .MuiDataGrid-cell":{py:"15px"},"&.MuiDataGrid-root--densityComfortable .MuiDataGrid-cell":{py:"22px"}}})}),(0,l.jsx)(u.A,{open:W,onClose:()=>{P(!1)},sx:{height:"100%"},children:(0,l.jsxs)(c.A,{elevation:4,square:!1,sx:{height:"80%",width:"100%",display:"flex",flexDirection:"column",p:2,gap:2,width:M?"90%":"50%",maxWidth:650,maxHeight:600,overflowY:"auto",scrollbarWidth:"thin",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)"},children:[(0,l.jsx)(m.default,{variant:"h5",children:"Crear nueva empresa"}),(0,l.jsx)(A.A,{steps:O,onFinish:Y})]})})]})}},32371:(e,a,n)=>{"use strict";n.d(a,{A:()=>g});var l=n(95155),t=n(12115),r=n(68998),s=n(10979),i=n(22678),o=n(90507),d=n(83774),u=n(91888),c=n(16508),m=n(39905),h=n(22282),v=n(9561),p=n(20719),f=n(31798),x=n(9313);function g(e){let{fields:a,values:n={},onChange:g,errors:b={},successMessage:j,errorMessage:C}=e,[A,_]=(0,t.useState)(!1);return(0,l.jsx)(r.default,{component:"form",sx:{height:"100%",width:"100%",margin:"0 auto",display:"flex",flexDirection:"column",justifyContent:"space-between"},children:(0,l.jsxs)(s.default,{spacing:2,sx:{mt:2},children:[a.map((e,a)=>{var t;return(0,l.jsx)(s.default,{children:(()=>{var a,t,r,s,v,j,C,y;switch(e.component){case"select":return(0,l.jsxs)(i.A,{fullWidth:!0,children:[(0,l.jsx)(o.A,{children:e.label}),(0,l.jsx)(d.A,{name:e.name,label:e.label,value:n[e.name]||"",onChange:a=>g(e.name,a.target.value),required:null!==(t=e.required)&&void 0!==t&&t,children:null===(a=e.options)||void 0===a?void 0:a.map((e,a)=>{var n;return(0,l.jsx)(u.A,{value:e.id,children:e.label},null!==(n=e.id)&&void 0!==n?n:a)})}),b&&b[e.name]&&(0,l.jsx)(c.A,{children:b[e.name]})]});case"date":return(0,l.jsx)(p.l,{label:e.label,value:null!==(r=n[e.name])&&void 0!==r?r:null,defaultValue:"",onChange:a=>g(e.name,a?a.toString():""),slotProps:{textField:{error:!!b[e.name],helperText:null!==(s=b[e.name])&&void 0!==s?s:""}}});default:return(0,l.jsx)(m.A,{fullWidth:!0,type:A?"text":null!==(v=e.type)&&void 0!==v?v:"text",label:e.label,name:e.name,required:null!==(j=e.required)&&void 0!==j&&j,value:null!==(C=n[e.name])&&void 0!==C?C:"",onChange:a=>g(e.name,a.target.value),error:!!b[e.name],helperText:null!==(y=b[e.name])&&void 0!==y?y:"",slotProps:{input:{endAdornment:"password"===e.type&&(0,l.jsx)(h.A,{onClick:()=>_(!A),children:A?(0,l.jsx)(f.A,{}):(0,l.jsx)(x.A,{})})}}})}})()},null!==(t=e.name)&&void 0!==t?t:a)}),(0,l.jsx)(v.default,{children:j}),(0,l.jsx)(v.default,{children:C})]})})}},57432:(e,a,n)=>{"use strict";n.d(a,{A:()=>p});var l=n(95155),t=n(12115),r=n(35901),s=n(48381),i=n(36520),o=n(98170),d=n(10979),u=n(9561),c=n(68998),m=n(22282),h=n(32371),v=n(16118);function p(e){let{steps:a,onFinish:n}=e,{errorMessage:p}=(0,v.P)(),[f,x]=(0,t.useState)(0),[g,b]=(0,t.useState)({}),j=()=>{b({});let e=a[f];if((null==e?void 0:e.schema)&&(null==e?void 0:e.values)){let a=e.schema.safeParse(e.values);if(!a.success){let e={};a.error.issues.forEach(a=>{e[a.path[0]]=a.message}),b(e);return}}b({}),f<a.length-1?x(e=>e+1):n&&n()},C=()=>{b({}),x(e=>e-1)};return(0,l.jsx)(r.A,{activeStep:f,orientation:"vertical",children:a.map((e,n)=>(0,l.jsxs)(s.A,{children:[(0,l.jsx)(i.A,{children:e.label}),(0,l.jsx)(o.A,{children:(0,l.jsxs)(d.default,{spacing:2,children:[e.description&&(0,l.jsx)(u.default,{children:e.description}),e.fields&&e.values&&e.setValues&&(0,l.jsx)(h.A,{fields:e.fields,values:e.values,onChange:(a,n)=>{e.setValues(e=>({...e,[a]:n}))},errors:g,errorMessage:p}),e.content&&e.content,(0,l.jsxs)(c.default,{children:[n<a.length-1?(0,l.jsx)(m.A,{variant:"contained",onClick:j,children:"Siguiente"}):(0,l.jsx)(m.A,{variant:"contained",onClick:j,children:"Finalizar"}),n>0&&(0,l.jsx)(m.A,{sx:{ml:2},onClick:C,children:"Atr\xe1s"})]})]})})]},n))})}}},e=>{var a=a=>e(e.s=a);e.O(0,[120,735,539,85,724,392,926,675,255,34,569,667,118,441,517,358],()=>a(19066)),_N_E=e.O()}]);