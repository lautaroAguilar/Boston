(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[606],{77237:(e,a,t)=>{Promise.resolve().then(t.bind(t,89192))},98358:(e,a,t)=>{"use strict";t.d(a,{default:()=>i});var l=t(22471),n=t(95155);let i=(0,l.A)((0,n.jsx)("path",{d:"M5 13.18v2.81c0 .73.4 1.41 1.04 1.76l5 2.73c.6.33 1.32.33 1.92 0l5-2.73c.64-.35 1.04-1.03 1.04-1.76v-2.81l-6.04 3.3c-.6.33-1.32.33-1.92 0zm6.04-9.66-8.43 4.6c-.69.38-.69 1.38 0 1.76l8.43 4.6c.6.33 1.32.33 1.92 0L21 10.09V16c0 .55.45 1 1 1s1-.45 1-1V9.59c0-.37-.2-.7-.52-.88l-9.52-5.19a2.04 2.04 0 0 0-1.92 0"}),"SchoolRounded")},89192:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>y});var l=t(95155),n=t(12115),i=t(57432),r=t(55295),s=t(10979),o=t(92608),d=t(78562),c=t(9561),u=t(98358),m=t(72971),h=t(16761),f=t(16118),p=t(43415);let x=p.z.object({first_name:p.z.string().trim().min(3,"El nombre debe contener al menos 3 letras"),last_name:p.z.string().trim().min(3,"El apellido debe contener al menos 3 letras"),email:p.z.string().trim().email("El email debe ser v\xe1lido"),sid:p.z.union([p.z.string().min(1),p.z.literal(""),p.z.null()]).optional(),cost_center_id:p.z.union([p.z.number().int("El ID del centro de costo debe ser un n\xfamero entero"),p.z.literal("")]).refine(e=>""!==e,{message:"Se debe seleccionar una opci\xf3n para asignar el centro de costo"}),sector_id:p.z.union([p.z.number().int("El ID del sector debe ser un n\xfamero entero"),p.z.literal("")]).refine(e=>""!==e,{message:"Se debe seleccionar una opci\xf3n para asignar el sector"})}),g=p.z.object({initial_leveling_date:p.z.string().refine(e=>!isNaN(Date.parse(e)),{message:"La fecha debe ser v\xe1lida"}),language_id:p.z.union([p.z.number().int("El ID del idioma debe ser un n\xfamero entero"),p.z.literal("")]).refine(e=>""!==e,{message:"Se debe seleccionar una opci\xf3n para asignar el idioma"}),module_id:p.z.union([p.z.number().int("El ID del m\xf3dulo debe ser un n\xfamero entero"),p.z.literal("")]).refine(e=>""!==e,{message:"Se debe seleccionar una opci\xf3n para asignar el m\xf3dulo"})});var v=t(78039),b=t(11896),_=t(93717),j=t(64527);let A=[{field:"student_id",headerName:"ID",minWidth:50},{field:"first_name",headerName:"Nombre",minWidth:150,flex:1},{field:"last_name",headerName:"Apellido",minWidth:150,flex:1},{field:"module_name",headerName:"M\xf3dulo actual",minWidth:150,flex:1,valueGetter:e=>e.row.module_name||"Sin m\xf3dulo asignado"},{field:"language_name",headerName:"Idioma",minWidth:150,flex:1,valueGetter:e=>e.row.language_name||"Sin idioma asignado"},{field:"sid",headerName:"SID",minWidth:150,flex:1},{field:"company_name",headerName:"Empresa",minWidth:150,flex:1},{field:"cost_center_name",headerName:"Centro de Costo",minWidth:150,flex:1},{field:"sector_name",headerName:"Sector",minWidth:150,flex:1}];function y(){let e=(0,_.A)(b.F),{fetchCostCenters:a,fetchSectors:t,sectors:p,costCenters:y}=(0,f.P)(),{setToolbarButtonAction:S,setOpenSnackbar:z,snackbarMessage:C,snackbarErrorMessage:N,selectedCompany:E,fetchModules:w,fetchLanguages:D,languages:q,modules:I}=(0,m.M)(),{fetchStudents:W,students:M,createStudent:P,updated:k}=(0,h.j)(),G=(0,r.A)("(max-width:600px)"),[V,F]=(0,n.useState)(!1),[R,T]=(0,n.useState)(!1),[L,O]=(0,n.useState)({first_name:"",last_name:"",email:"",company_id:"",cost_center_id:"",sector_id:"",sid:""}),[H,U]=(0,n.useState)({initial_leveling_date:"",language_id:"",module_id:""});function J(){F(!0)}let Y=[{label:"Datos Personales",description:"Completa los datos personales del alumno",schema:x,fields:[{name:"first_name",label:"Nombre",required:!0},{name:"last_name",label:"Apellido",required:!0},{name:"email",label:"Email",required:!0,type:"email"},{name:"cost_center_id",label:"Centro de Costo",component:"select",options:E?y.map(e=>({id:e.cost_center_id,label:e.cost_center_name})):[{id:0,label:"No se encontraron centros de costo"}],required:!0},{name:"sector_id",label:"Sector",component:"select",options:E?p.map(e=>({id:e.sector_id,label:e.sector_name})):[{id:0,label:"No se encontraron sectores"}],required:!0},{name:"sid",label:"SID"}],values:L,setValues:O},{label:"Detalles de Nivelaci\xf3n",schema:g,fields:[{name:"initial_leveling_date",label:"Fecha de Nivelaci\xf3n",type:"date",required:!0},{name:"language_id",label:"Idioma",component:"select",options:q.map(e=>({id:e.id,label:e.name})),required:!0},{name:"module_id",label:"M\xf3dulo y Nivel",component:"select",options:I.map(e=>({id:e.id,label:e.name})),required:!0}],values:H,setValues:U}],B=async()=>{let e={...L,...H,company_id:E};await P(e),F(!1)};return(0,n.useEffect)(()=>{S({label:"Crear nuevo",action:J,icon:(0,l.jsx)(u.default,{})})},[S]),(0,n.useEffect)(()=>{(C||N)&&z(!0)},[C,N]),(0,n.useEffect)(()=>{W()},[k,E]),(0,n.useEffect)(()=>{E&&(a(E),t(E)),w(),D()},[E]),(0,l.jsxs)(s.default,{children:[(0,l.jsx)(j.A,{theme:e,children:(0,l.jsx)(v.z,{columns:A,rows:M,getRowId:e=>e.student_id,getEstimatedRowHeight:()=>100,getRowHeight:()=>"auto",sx:{width:"100%","&.MuiDataGrid-root--densityCompact .MuiDataGrid-cell":{py:1},"&.MuiDataGrid-root--densityStandard .MuiDataGrid-cell":{py:"15px"},"&.MuiDataGrid-root--densityComfortable .MuiDataGrid-cell":{py:"22px"}}})}),(0,l.jsx)(o.A,{open:V,onClose:()=>{F(!1)},sx:{height:"100%"},children:(0,l.jsxs)(d.A,{elevation:4,square:!1,sx:{height:"80%",width:"100%",display:"flex",flexDirection:"column",p:2,gap:2,width:G?"90%":"50%",maxWidth:650,maxHeight:600,overflowY:"auto",scrollbarWidth:"thin",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)"},children:[(0,l.jsx)(c.default,{variant:"h5",children:"Agregar nuevo alumno"}),(0,l.jsx)(i.A,{steps:Y,onFinish:B})]})})]})}},32371:(e,a,t)=>{"use strict";t.d(a,{A:()=>v});var l=t(95155),n=t(12115),i=t(68998),r=t(10979),s=t(22678),o=t(90507),d=t(83774),c=t(91888),u=t(16508),m=t(39905),h=t(22282),f=t(9561),p=t(20719),x=t(31798),g=t(9313);function v(e){let{fields:a,values:t={},onChange:v,errors:b={},successMessage:_,errorMessage:j}=e,[A,y]=(0,n.useState)(!1);return(0,l.jsx)(i.default,{component:"form",sx:{height:"100%",width:"100%",margin:"0 auto",display:"flex",flexDirection:"column",justifyContent:"space-between"},children:(0,l.jsxs)(r.default,{spacing:2,sx:{mt:2},children:[a.map((e,a)=>{var n;return(0,l.jsx)(r.default,{children:(()=>{var a,n,i,r,f,_,j,S;switch(e.component){case"select":return(0,l.jsxs)(s.A,{fullWidth:!0,children:[(0,l.jsx)(o.A,{children:e.label}),(0,l.jsx)(d.A,{name:e.name,label:e.label,value:t[e.name]||"",onChange:a=>v(e.name,a.target.value),required:null!==(n=e.required)&&void 0!==n&&n,children:null===(a=e.options)||void 0===a?void 0:a.map((e,a)=>{var t;return(0,l.jsx)(c.A,{value:e.id,children:e.label},null!==(t=e.id)&&void 0!==t?t:a)})}),b&&b[e.name]&&(0,l.jsx)(u.A,{children:b[e.name]})]});case"date":return(0,l.jsx)(p.l,{label:e.label,value:null!==(i=t[e.name])&&void 0!==i?i:null,defaultValue:"",onChange:a=>v(e.name,a?a.toString():""),slotProps:{textField:{error:!!b[e.name],helperText:null!==(r=b[e.name])&&void 0!==r?r:""}}});default:return(0,l.jsx)(m.A,{fullWidth:!0,type:A?"text":null!==(f=e.type)&&void 0!==f?f:"text",label:e.label,name:e.name,required:null!==(_=e.required)&&void 0!==_&&_,value:null!==(j=t[e.name])&&void 0!==j?j:"",onChange:a=>v(e.name,a.target.value),error:!!b[e.name],helperText:null!==(S=b[e.name])&&void 0!==S?S:"",slotProps:{input:{endAdornment:"password"===e.type&&(0,l.jsx)(h.A,{onClick:()=>y(!A),children:A?(0,l.jsx)(x.A,{}):(0,l.jsx)(g.A,{})})}}})}})()},null!==(n=e.name)&&void 0!==n?n:a)}),(0,l.jsx)(f.default,{children:_}),(0,l.jsx)(f.default,{children:j})]})})}},57432:(e,a,t)=>{"use strict";t.d(a,{A:()=>p});var l=t(95155),n=t(12115),i=t(35901),r=t(48381),s=t(36520),o=t(98170),d=t(10979),c=t(9561),u=t(68998),m=t(22282),h=t(32371),f=t(16118);function p(e){let{steps:a,onFinish:t}=e,{errorMessage:p}=(0,f.P)(),[x,g]=(0,n.useState)(0),[v,b]=(0,n.useState)({}),_=()=>{b({});let e=a[x];if((null==e?void 0:e.schema)&&(null==e?void 0:e.values)){let a=e.schema.safeParse(e.values);if(!a.success){let e={};a.error.issues.forEach(a=>{e[a.path[0]]=a.message}),b(e);return}}b({}),x<a.length-1?g(e=>e+1):t&&t()},j=()=>{b({}),g(e=>e-1)};return(0,l.jsx)(i.A,{activeStep:x,orientation:"vertical",children:a.map((e,t)=>(0,l.jsxs)(r.A,{children:[(0,l.jsx)(s.A,{children:e.label}),(0,l.jsx)(o.A,{children:(0,l.jsxs)(d.default,{spacing:2,children:[e.description&&(0,l.jsx)(c.default,{children:e.description}),e.fields&&e.values&&e.setValues&&(0,l.jsx)(h.A,{fields:e.fields,values:e.values,onChange:(a,t)=>{e.setValues(e=>({...e,[a]:t}))},errors:v,errorMessage:p}),e.content&&e.content,(0,l.jsxs)(u.default,{children:[t<a.length-1?(0,l.jsx)(m.A,{variant:"contained",onClick:_,children:"Siguiente"}):(0,l.jsx)(m.A,{variant:"contained",onClick:_,children:"Finalizar"}),t>0&&(0,l.jsx)(m.A,{sx:{ml:2},onClick:j,children:"Atr\xe1s"})]})]})})]},t))})}},16761:(e,a,t)=>{"use strict";t.d(a,{N:()=>o,j:()=>d});var l=t(95155),n=t(12115),i=t(44026),r=t(72971);let s=(0,n.createContext)(),o=e=>{let{children:a}=e,{setSnackbarErrorMessage:t,setSnackbarMessage:o,selectedCompany:d}=(0,r.M)(),[c,u]=(0,n.useState)([]),[m,h]=(0,n.useState)(!1),[f,p]=(0,n.useState)(null),x=async e=>{try{let a=await fetch("".concat(i.A.API_URL,"/students"),{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),l=a.json();if(!a.ok){if(Array.isArray(l)){let e=l.reduce((e,a)=>(e[a.path[0]]=a.message,e),{});setFormErrors(e)}else t(l.error);return}return o("Alumno creado correctamente"),h(e=>!e),l}catch(e){console.log("Error de red al crear estudiante:",e)}},g=async()=>{try{let e=await fetch("".concat(i.A.API_URL,"/students?companyId=").concat(d),{method:"GET",credentials:"include"}),a=await e.json();e.ok||t(a.message),u(a)}catch(e){console.log("Error de red al buscar estudiantes:",e)}};return(0,l.jsx)(s.Provider,{value:{students:c,errorMessage:f,updated:m,createStudent:x,fetchStudents:g},children:a})},d=()=>(0,n.useContext)(s)}},e=>{var a=a=>e(e.s=a);e.O(0,[120,735,539,85,724,392,926,675,255,34,569,118,441,517,358],()=>a(77237)),_N_E=e.O()}]);