(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[606],{77237:(e,a,l)=>{Promise.resolve().then(l.bind(l,89192))},98358:(e,a,l)=>{"use strict";l.d(a,{default:()=>i});var n=l(22471),t=l(95155);let i=(0,n.A)((0,t.jsx)("path",{d:"M5 13.18v2.81c0 .73.4 1.41 1.04 1.76l5 2.73c.6.33 1.32.33 1.92 0l5-2.73c.64-.35 1.04-1.03 1.04-1.76v-2.81l-6.04 3.3c-.6.33-1.32.33-1.92 0zm6.04-9.66-8.43 4.6c-.69.38-.69 1.38 0 1.76l8.43 4.6c.6.33 1.32.33 1.92 0L21 10.09V16c0 .55.45 1 1 1s1-.45 1-1V9.59c0-.37-.2-.7-.52-.88l-9.52-5.19a2.04 2.04 0 0 0-1.92 0"}),"SchoolRounded")},89192:(e,a,l)=>{"use strict";l.r(a),l.d(a,{default:()=>y});var n=l(95155),t=l(12115),i=l(57432),r=l(55295),s=l(10979),o=l(92608),d=l(78562),c=l(9561),u=l(98358),m=l(72971),h=l(16761),p=l(16118),f=l(43415);let x=f.z.object({first_name:f.z.string().trim().min(3,"El nombre debe contener al menos 3 letras"),last_name:f.z.string().trim().min(3,"El apellido debe contener al menos 3 letras"),email:f.z.string().trim().email("El email debe ser v\xe1lido"),sid:f.z.union([f.z.string().min(1),f.z.literal(""),f.z.null()]).optional(),cost_center_id:f.z.union([f.z.number().int("El ID del centro de costo debe ser un n\xfamero entero"),f.z.literal("")]).refine(e=>""!==e,{message:"Se debe seleccionar una opci\xf3n para asignar el centro de costo"}),sector_id:f.z.union([f.z.number().int("El ID del sector debe ser un n\xfamero entero"),f.z.literal("")]).refine(e=>""!==e,{message:"Se debe seleccionar una opci\xf3n para asignar el sector"})}),v=f.z.object({initial_leveling_date:f.z.string().refine(e=>!isNaN(Date.parse(e)),{message:"La fecha debe ser v\xe1lida"}),language_id:f.z.union([f.z.number().int("El ID del idioma debe ser un n\xfamero entero"),f.z.literal("")]).refine(e=>""!==e,{message:"Se debe seleccionar una opci\xf3n para asignar el idioma"}),module_id:f.z.union([f.z.number().int("El ID del m\xf3dulo debe ser un n\xfamero entero"),f.z.literal("")]).refine(e=>""!==e,{message:"Se debe seleccionar una opci\xf3n para asignar el m\xf3dulo"}),level_id:f.z.union([f.z.number().int("El ID del nivel debe ser un n\xfamero entero"),f.z.literal("")]).refine(e=>""!==e,{message:"Se debe seleccionar una opci\xf3n para asignar el nivel"})});var b=l(78039),g=l(11896),_=l(93717),j=l(64527);let A=[{field:"student_id",headerName:"ID",minWidth:50},{field:"first_name",headerName:"Nombre",minWidth:150,flex:1},{field:"last_name",headerName:"Apellido",minWidth:150,flex:1},{field:"modules",headerName:"M\xf3dulo y nivel",minWidth:150,flex:1},{field:"sid",headerName:"SID",minWidth:150,flex:1},{field:"company_name",headerName:"Empresa",minWidth:150,flex:1},{field:"cost_center_name",headerName:"Centro de Costo",minWidth:150,flex:1},{field:"sector_name",headerName:"Sector",minWidth:150,flex:1}];function y(){let e=(0,_.A)(g.F),{fetchCostCenters:a,fetchSectors:l,sectors:f,costCenters:y}=(0,p.P)(),{setToolbarButtonAction:z,setOpenSnackbar:S,snackbarMessage:C,snackbarErrorMessage:E,selectedCompany:N,fetchModules:w,fetchLanguages:D,fetchLevels:q,languages:I,levels:M,modules:W}=(0,m.M)(),{fetchStudents:P,students:k,createStudent:G,updated:V}=(0,h.j)(),F=(0,r.A)("(max-width:600px)"),[R,T]=(0,t.useState)(!1),[L,O]=(0,t.useState)(!1),[H,U]=(0,t.useState)({first_name:"",last_name:"",email:"",company_id:"",cost_center_id:"",sector_id:"",sid:""}),[J,Y]=(0,t.useState)({initial_leveling_date:"",language_id:"",module_id:"",level_id:""});function B(){T(!0)}let K=[{label:"Datos Personales",description:"Completa los datos personales del alumno",schema:x,fields:[{name:"first_name",label:"Nombre",required:!0},{name:"last_name",label:"Apellido",required:!0},{name:"email",label:"Email",required:!0,type:"email"},{name:"cost_center_id",label:"Centro de Costo",component:"select",options:N?y.map(e=>({id:e.cost_center_id,label:e.cost_center_name})):[{id:0,label:"No se encontraron centros de costo"}],required:!0},{name:"sector_id",label:"Sector",component:"select",options:N?f.map(e=>({id:e.sector_id,label:e.sector_name})):[{id:0,label:"No se encontraron sectores"}],required:!0}],values:H,setValues:U},{label:"Detalles de Nivelaci\xf3n",schema:v,fields:[{name:"initial_leveling_date",label:"Fecha de Nivelaci\xf3n",type:"date",required:!0},{name:"language_id",label:"Idioma",component:"select",options:I.map(e=>({id:e.id,label:e.name})),required:!0},{name:"module_id",label:"M\xf3dulo",component:"select",options:W.map(e=>({id:e.id,label:e.name})),required:!0},{name:"level_id",label:"Nivel",component:"select",options:M.map(e=>({id:e.id,label:e.name})),required:!0}],values:J,setValues:Y}],Q=async()=>{let e={...H,...J,company_id:N};await G(e),T(!1)};return(0,t.useEffect)(()=>{z({label:"Crear nuevo",action:B,icon:(0,n.jsx)(u.default,{})})},[z]),(0,t.useEffect)(()=>{(C||E)&&S(!0)},[C,E]),(0,t.useEffect)(()=>{P()},[V,N]),(0,t.useEffect)(()=>{N&&(a(N),l(N)),w(),D(),q()},[N]),(0,n.jsxs)(s.default,{children:[(0,n.jsx)(j.A,{theme:e,children:(0,n.jsx)(b.z,{columns:A,rows:k,getRowId:e=>e.student_id,getEstimatedRowHeight:()=>100,getRowHeight:()=>"auto",sx:{width:"100%","&.MuiDataGrid-root--densityCompact .MuiDataGrid-cell":{py:1},"&.MuiDataGrid-root--densityStandard .MuiDataGrid-cell":{py:"15px"},"&.MuiDataGrid-root--densityComfortable .MuiDataGrid-cell":{py:"22px"}}})}),(0,n.jsx)(o.A,{open:R,onClose:()=>{T(!1)},sx:{height:"100%"},children:(0,n.jsxs)(d.A,{elevation:4,square:!1,sx:{height:"80%",width:"100%",display:"flex",flexDirection:"column",p:2,gap:2,width:F?"90%":"50%",maxWidth:650,maxHeight:600,overflowY:"auto",scrollbarWidth:"thin",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)"},children:[(0,n.jsx)(c.default,{variant:"h5",children:"Agregar nuevo alumno"}),(0,n.jsx)(i.A,{steps:K,onFinish:Q})]})})]})}},32371:(e,a,l)=>{"use strict";l.d(a,{A:()=>b});var n=l(95155),t=l(12115),i=l(68998),r=l(10979),s=l(22678),o=l(90507),d=l(83774),c=l(91888),u=l(16508),m=l(39905),h=l(22282),p=l(9561),f=l(20719),x=l(31798),v=l(9313);function b(e){let{fields:a,values:l={},onChange:b,errors:g={},successMessage:_,errorMessage:j}=e,[A,y]=(0,t.useState)(!1);return(0,n.jsx)(i.default,{component:"form",sx:{height:"100%",width:"100%",margin:"0 auto",display:"flex",flexDirection:"column",justifyContent:"space-between"},children:(0,n.jsxs)(r.default,{spacing:2,sx:{mt:2},children:[a.map((e,a)=>{var t;return(0,n.jsx)(r.default,{children:(()=>{var a,t,i,r,p,_,j,z;switch(e.component){case"select":return(0,n.jsxs)(s.A,{fullWidth:!0,children:[(0,n.jsx)(o.A,{children:e.label}),(0,n.jsx)(d.A,{name:e.name,label:e.label,value:l[e.name]||"",onChange:a=>b(e.name,a.target.value),required:null!==(t=e.required)&&void 0!==t&&t,children:null===(a=e.options)||void 0===a?void 0:a.map((e,a)=>{var l;return(0,n.jsx)(c.A,{value:e.id,children:e.label},null!==(l=e.id)&&void 0!==l?l:a)})}),g&&g[e.name]&&(0,n.jsx)(u.A,{children:g[e.name]})]});case"date":return(0,n.jsx)(f.l,{label:e.label,value:null!==(i=l[e.name])&&void 0!==i?i:null,defaultValue:"",onChange:a=>b(e.name,a?a.toString():""),slotProps:{textField:{error:!!g[e.name],helperText:null!==(r=g[e.name])&&void 0!==r?r:""}}});default:return(0,n.jsx)(m.A,{fullWidth:!0,type:A?"text":null!==(p=e.type)&&void 0!==p?p:"text",label:e.label,name:e.name,required:null!==(_=e.required)&&void 0!==_&&_,value:null!==(j=l[e.name])&&void 0!==j?j:"",onChange:a=>b(e.name,a.target.value),error:!!g[e.name],helperText:null!==(z=g[e.name])&&void 0!==z?z:"",slotProps:{input:{endAdornment:"password"===e.type&&(0,n.jsx)(h.A,{onClick:()=>y(!A),children:A?(0,n.jsx)(x.A,{}):(0,n.jsx)(v.A,{})})}}})}})()},null!==(t=e.name)&&void 0!==t?t:a)}),(0,n.jsx)(p.default,{children:_}),(0,n.jsx)(p.default,{children:j})]})})}},57432:(e,a,l)=>{"use strict";l.d(a,{A:()=>f});var n=l(95155),t=l(12115),i=l(35901),r=l(48381),s=l(36520),o=l(98170),d=l(10979),c=l(9561),u=l(68998),m=l(22282),h=l(32371),p=l(16118);function f(e){let{steps:a,onFinish:l}=e,{errorMessage:f}=(0,p.P)(),[x,v]=(0,t.useState)(0),[b,g]=(0,t.useState)({}),_=()=>{g({});let e=a[x];if((null==e?void 0:e.schema)&&(null==e?void 0:e.values)){let a=e.schema.safeParse(e.values);if(!a.success){let e={};a.error.issues.forEach(a=>{e[a.path[0]]=a.message}),g(e);return}}g({}),x<a.length-1?v(e=>e+1):l&&l()},j=()=>{g({}),v(e=>e-1)};return(0,n.jsx)(i.A,{activeStep:x,orientation:"vertical",children:a.map((e,l)=>(0,n.jsxs)(r.A,{children:[(0,n.jsx)(s.A,{children:e.label}),(0,n.jsx)(o.A,{children:(0,n.jsxs)(d.default,{spacing:2,children:[e.description&&(0,n.jsx)(c.default,{children:e.description}),e.fields&&e.values&&e.setValues&&(0,n.jsx)(h.A,{fields:e.fields,values:e.values,onChange:(a,l)=>{e.setValues(e=>({...e,[a]:l}))},errors:b,errorMessage:f}),e.content&&e.content,(0,n.jsxs)(u.default,{children:[l<a.length-1?(0,n.jsx)(m.A,{variant:"contained",onClick:_,children:"Siguiente"}):(0,n.jsx)(m.A,{variant:"contained",onClick:_,children:"Finalizar"}),l>0&&(0,n.jsx)(m.A,{sx:{ml:2},onClick:j,children:"Atr\xe1s"})]})]})})]},l))})}},16761:(e,a,l)=>{"use strict";l.d(a,{N:()=>o,j:()=>d});var n=l(95155),t=l(12115),i=l(44026),r=l(72971);let s=(0,t.createContext)(),o=e=>{let{children:a}=e,{setSnackbarErrorMessage:l,setSnackbarMessage:o,selectedCompany:d}=(0,r.M)(),[c,u]=(0,t.useState)([]),[m,h]=(0,t.useState)(!1),[p,f]=(0,t.useState)(null),x=async e=>{try{let a=await fetch("".concat(i.A.API_URL,"/students"),{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),n=a.json();if(!a.ok){if(Array.isArray(n)){let e=n.reduce((e,a)=>(e[a.path[0]]=a.message,e),{});setFormErrors(e)}else l(n.error);return}return o("Alumno creado correctamente"),h(e=>!e),n}catch(e){console.log("Error de red al crear estudiante:",e)}},v=async()=>{try{let e=await fetch("".concat(i.A.API_URL,"/students?companyId=").concat(d),{method:"GET",credentials:"include"}),a=await e.json();e.ok||l(a.message),u(a)}catch(e){console.log("Error de red al buscar estudiantes:",e)}};return(0,n.jsx)(s.Provider,{value:{students:c,errorMessage:p,updated:m,createStudent:x,fetchStudents:v},children:a})},d=()=>(0,t.useContext)(s)}},e=>{var a=a=>e(e.s=a);e.O(0,[120,735,539,85,724,392,926,675,255,34,569,118,441,517,358],()=>a(77237)),_N_E=e.O()}]);